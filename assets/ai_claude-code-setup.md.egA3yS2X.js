import{_ as s,o as a,c as t,ae as i}from"./chunks/framework.h0LyDJ8h.js";const o="/blog/assets/claude-connect-error.DleCtBIJ.png",k=JSON.parse('{"title":"Claude Code 安装配置","description":"","frontmatter":{},"headers":[],"relativePath":"ai/claude-code-setup.md","filePath":"ai/claude-code-setup.md"}'),n={name:"ai/claude-code-setup.md"};function d(l,e,c,p,h,r){return a(),t("div",null,[...e[0]||(e[0]=[i(`<h1 id="claude-code-安装配置" tabindex="-1">Claude Code 安装配置 <a class="header-anchor" href="#claude-code-安装配置" aria-label="Permalink to &quot;Claude Code 安装配置&quot;">​</a></h1><p>Claude Code 是 Anthropic 的智能编程工具，支持原生安装、Node 与 VS Code 插件。前置：Claude 账号（Pro/Max 或 API）、或其他大模型 API、4GB+ 内存。</p><hr><h2 id="一、有网络代理-推荐安装-原生" tabindex="-1">一、有网络代理：推荐安装（原生） <a class="header-anchor" href="#一、有网络代理-推荐安装-原生" aria-label="Permalink to &quot;一、有网络代理：推荐安装（原生）&quot;">​</a></h2><table tabindex="0"><thead><tr><th>系统</th><th>命令</th></tr></thead><tbody><tr><td>macOS</td><td><code>curl -fsSL https://claude.ai/install.sh | bash</code> 或 <code>brew install --cask claude-code</code></td></tr><tr><td>Windows</td><td>管理员 PowerShell：<code>irm https://claude.ai/install.ps1 | iex</code> 或 <code>winget install Anthropic.ClaudeCode</code></td></tr></tbody></table><p>安装后执行 <code>claude --version</code> 或 <code>claude doctor</code> 验证。</p><p><strong>国内网络</strong>：脚本/brew/winget 可能超时。若本机已开代理（如 Clash），先设代理再安装。</p><ul><li><strong>方式 1</strong>：Clash → General → Port → 复制端口号 → 打开终端粘贴并回车 → 再执行安装命令。</li><li><strong>方式 2</strong>：下面示例里 <code>127.0.0.1:7890</code> 表示「本机地址:端口」，请改成你实际代理的地址和端口（如 Clash 默认常为 7890）： <ul><li>Mac/Linux：<code>export HTTP_PROXY=http://127.0.0.1:7890 HTTPS_PROXY=http://127.0.0.1:7890 ALL_PROXY=http://127.0.0.1:7890 NO_PROXY=localhost,127.0.0.1,::1</code></li><li>Windows PowerShell：<code>$env:HTTP_PROXY=&quot;http://127.0.0.1:7890&quot;; $env:HTTPS_PROXY=$env:HTTP_PROXY; $env:ALL_PROXY=$env:HTTP_PROXY; $env:NO_PROXY=&quot;localhost,127.0.0.1&quot;</code></li></ul></li></ul><p>代理需放行：<code>claude.ai</code>、<code>api.anthropic.com</code> 等。</p><hr><h2 id="二、node-安装-不推荐-仅作备选" tabindex="-1">二、Node 安装（不推荐，仅作备选） <a class="header-anchor" href="#二、node-安装-不推荐-仅作备选" aria-label="Permalink to &quot;二、Node 安装（不推荐，仅作备选）&quot;">​</a></h2><p>官方已不推荐通过 Node 安装。若必须用 Node，先 <code>nvm use 20</code>（或当前 LTS），再任选一种包管理器全局安装：</p><table tabindex="0"><thead><tr><th>包管理器</th><th>安装</th><th>卸载</th></tr></thead><tbody><tr><td>npm</td><td><code>npm install -g @anthropic-ai/claude-code</code></td><td><code>npm uninstall -g @anthropic-ai/claude-code</code></td></tr><tr><td>yarn</td><td><code>yarn global add @anthropic-ai/claude-code</code></td><td><code>yarn global remove @anthropic-ai/claude-code</code></td></tr><tr><td>pnpm</td><td><code>pnpm add -g @anthropic-ai/claude-code</code></td><td><code>pnpm remove -g @anthropic-ai/claude-code</code></td></tr></tbody></table><p><strong>nvm 注意</strong>：全局安装会装到当前 nvm 选中的 Node；换版本后需在该版本下重装。确保 nvm 已写入 <code>~/.zshrc</code>/<code>~/.bashrc</code>（Mac）或 PATH（Windows）。</p><hr><h2 id="三、vs-code-插件" tabindex="-1">三、VS Code 插件 <a class="header-anchor" href="#三、vs-code-插件" aria-label="Permalink to &quot;三、VS Code 插件&quot;">​</a></h2><p>VS Code 内按 <code>Ctrl+Shift+X</code>（Mac：<code>Cmd+Shift+X</code>）→ 搜索「Claude Code」→ 安装 Anthropic 官方扩展。需 VS Code ≥ 1.98.0 及 Pro/Max 订阅或 API Key。</p><h3 id="如何配置" tabindex="-1">如何配置 <a class="header-anchor" href="#如何配置" aria-label="Permalink to &quot;如何配置&quot;">​</a></h3><ol><li><strong>打开配置</strong>：安装后在侧栏点击 Claude（Spark 图标）或右下角「✱ Claude Code」，或按 <code>Ctrl+Shift+P</code>（Mac：<code>Cmd+Shift+P</code>）搜索「Claude Code」→ 选择「Open in New Tab」等；首次使用会提示登录或配置 API Key。</li><li><strong>使用 Anthropic 账号</strong>：按提示在浏览器中登录 Claude 账号（需网络可访问 anthropic.com）。</li><li><strong>使用 API Key 或国内大模型（推荐用 ~/.claude/settings.json）</strong>：扩展与 CLI 共用同一套配置，官方推荐在 <strong><code>~/.claude/settings.json</code></strong>（Windows：<code>%USERPROFILE%\\.claude\\settings.json</code>）里用 <strong><code>env</code></strong> 配置，扩展和终端里的 <code>claude</code> 都会生效：<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;env&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;ANTHROPIC_API_KEY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-ant-你的密钥&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>使用国内大模型（如阿里云百炼）时，需同时配置 Base URL 与模型，例如：<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;env&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;ANTHROPIC_BASE_URL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://dashscope.aliyuncs.com/apps/anthropic&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;ANTHROPIC_API_KEY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;你的百炼 API Key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;ANTHROPIC_MODEL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;qwen3-coder-plus&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div>详细步骤与模型列表见 <a href="https://help.aliyun.com/zh/model-studio/claude-code#8ab558818fv3f" target="_blank" rel="noreferrer">阿里云百炼：Claude Code</a>。</li><li><strong>仅扩展内生效：VS Code 设置</strong>：打开 VS Code 设置（<code>Ctrl+,</code> / <code>Cmd+,</code>）→ 扩展 → Claude Code，找到 <strong>Environment Variables</strong>，或在「打开设置(JSON)」里添加（键名为 <strong><code>claudeCode.environmentVariables</code></strong>）：<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;claudeCode.environmentVariables&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: [</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  { </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;name&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ANTHROPIC_API_KEY&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">&quot;value&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;sk-ant-xxx&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span></code></pre></div>使用国内大模型时同样可在此配置 <code>ANTHROPIC_BASE_URL</code>、<code>ANTHROPIC_API_KEY</code>、<code>ANTHROPIC_MODEL</code>。若无法登录，可勾选 <strong>Disable Login Prompt</strong>（跳过登录提示）。</li></ol><p>配置后重启 VS Code 或执行「Developer: Reload Window」使配置生效。</p><hr><h2 id="四、登录与-api-key-跳过浏览器登录" tabindex="-1">四、登录与 API Key（跳过浏览器登录） <a class="header-anchor" href="#四、登录与-api-key-跳过浏览器登录" aria-label="Permalink to &quot;四、登录与 API Key（跳过浏览器登录）&quot;">​</a></h2><p>初次使用 Claude Code 时，可能会强制要求登录 Anthropic 账户。请按以下步骤操作以跳过该流程（步骤与图示详见 <a href="https://help.aliyun.com/zh/model-studio/claude-code#8ab558818fv3f" target="_blank" rel="noreferrer">阿里云百炼：Claude Code</a>）。</p><p>若出现无法连接 Anthropic 服务的提示（如 <code>Failed to connect to api.anthropic.com: ERR_BAD_REQUEST</code>），可先按下面步骤配置 <code>.claude.json</code> 跳过登录，或改用国内大模型 API（如阿里云百炼）并配置对应 Base URL 与 API Key。</p><p><img src="`+o+`" alt="无法连接 Anthropic 服务时的界面"></p><ol><li><p><strong>找到用户主目录下的 <code>.claude.json</code> 文件</strong></p><ul><li>macOS / Linux：<code>~/.claude.json</code></li><li>Windows：<code>C:\\Users\\%USERNAME%\\.claude.json</code><br> （若不存在可新建该文件。）</li></ul></li><li><p><strong>将 <code>hasCompletedOnboarding</code> 设为 <code>true</code></strong>，保存文件：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;hasCompletedOnboarding&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li><p><strong>新开一个终端</strong>，再执行 <code>claude</code>，即可跳过浏览器登录流程。</p></li></ol><hr><p><strong>改用 API Key（按量计费、不依赖浏览器）</strong>：具体参考所使用的大模型官方文档，例如 <a href="https://help.aliyun.com/zh/model-studio/claude-code#8ab558818fv3f" target="_blank" rel="noreferrer">阿里云百炼：Claude Code</a>。</p><p><strong>常用命令</strong>：<code>claude</code>、<code>claude &quot;解释这个项目&quot;</code>、<code>claude -p &quot;问题&quot;</code>。</p>`,29)])])}const g=s(n,[["render",d]]);export{k as __pageData,g as default};
